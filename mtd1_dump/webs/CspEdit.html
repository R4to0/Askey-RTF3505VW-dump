<html>
   <head>
      <meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
      <link rel="stylesheet" href='stylemain.css' type='text/css'>
         <link rel="stylesheet" href='colors.css' type='text/css'>
            <script language="javascript" src="util.js"></script>
            <script language="javascript">
<!-- hide
var iidStack = '';

function frmLoad() {
   var names = '<%ejGet(paramBuf)%>'.split('/');
   if (names.length == 10) {
      iidStack = names[0];
      with (document.forms[0]) {
         VendorClassId.value = htmlDecode(names[1]);
         MinIpAddr.value = names[2];
         MaxIpAddr.value = names[3];
         SubnetMask.value = names[4];
         Router.value = names[5];
         var dns = names[6].split(',');
         DnsServer1.value = (dns.length>0)?dns[0]:'';
         DnsServer2.value = (dns.length>1)?dns[1]:'';
         Option42.value  = htmlDecode(names[7]);
         Option100.value = htmlDecode(names[8]);
         Option101.value = htmlDecode(names[9]);

         selectFocus(VendorClassId);
      }
   }
}

function htmlDecode(s) {
   var div = document.createElement('div');
   div.innerHTML = s;
   return div.innerText;
}

function selectFocus(inputText) {
   inputText.focus();
   inputText.setSelectionRange(0, inputText.value.length);
}

function btnApply() {
   var loc = 'dhcpdconditionallease.cmd?action=edit';
   with ( document.forms[0] ) {
      if (isXSS(VendorClassId.value)) {
         alert('!!Scripting Cross-site (Persistent) - Persistent XSS on Vendor Class Id');
         selectFocus(VendorClassId);
         return;
      }
      else if (isValidIpAddress(MinIpAddr.value) == false) {
         alert('MinIpAddr "' + MinIpAddr.value + '" is invalid IP address.');
         selectFocus(MinIpAddr);
         return;
      }
      else if (isValidIpAddress(MaxIpAddr.value) == false) {
         alert('MaxIpAddr "' + MaxIpAddr.value + '" is invalid IP address.');
         selectFocus(MaxIpAddr);
         return;
      }
      else if (isValidSubnetMask(SubnetMask.value) == false) {
         alert('SubnetMask "' + SubnetMask.value + '" is invalid IP address.');
         selectFocus(SubnetMask);
         return;
      }
      else if (isValidIpAddress(Router.value) == false) {
         alert('Router "' + Router.value + '" is invalid IP address.');
         selectFocus(Router);
         return;
      }
      else if (DnsServer1.value!= "" && isValidIpAddress(DnsServer1.value) == false) {
         alert('DnsServer1 "' + DnsServer1.value + '" is invalid IP address.');
         selectFocus(DnsServer1);
         return;
      }
      else if (DnsServer2.value!= "" && isValidIpAddress(DnsServer2.value) == false) {
         alert('DnsServer2 "' + DnsServer2.value + '" is invalid IP address.');
         selectFocus(DnsServer2);
         return;
      }
      else {
         loc += '&iid=' + iidStack;
         loc += '&VendorClassId=' + encodeURIComponent(VendorClassId.value);
         loc += '&MinIpAddr=' + MinIpAddr.value;
         loc += '&MaxIpAddr=' + MaxIpAddr.value;
         loc += '&Router=' + Router.value;
         loc += '&SubnetMask=' + SubnetMask.value;
         loc += '&DnsServer1=' + DnsServer1.value;
         loc += '&DnsServer2=' + DnsServer2.value;
         loc += '&Option42='  + Option42.value;
         loc += '&Option100=' + encodeURIComponent(Option100.value);
         loc += '&Option101=' + encodeURIComponent(Option101.value);
         loc += '&sessionKey=<%ejGetOther(sessionKey)%>';
         var code = 'location="' + loc + '"';
         eval(code);
      }
   }
}

// done hiding -->
</script>
   </head>
   <body onLoad='frmLoad()'>
      <blockquote>
         <form>
            <b>Edit DHCP Conditional Lease </b><br>
            <br>
            Modify the information of conditional pool then click "Apply/Save".<br>
            <br>
            <br>
            <table border="0" cellpadding="0" cellspacing="0">
               <tr>
                  <td >Vendor Class Id:</td>
                  <td><input type='text' name='VendorClassId'></td>
               </tr>
               <tr>
                  <td>Min IP Address:</td>
                  <td><input type='text' name='MinIpAddr'> </td>
               </tr>
               <tr>
                  <td>Max IP Address:</td>
                  <td><input type='text' name='MaxIpAddr'></td>
               </tr>
               <tr>
                  <td>Subnet Mask:</td>
                  <td><input type='text' name='SubnetMask'></td>
               </tr>
               <tr>
                  <td>Router:</td>
                  <td><input type='text' name='Router'></td>
               </tr>
               <tr>
                  <td>DNS Server1:</td>
                  <td><input type='text' name='DnsServer1'></td>
               </tr>
               <tr>
                  <td>DNS Server2:</td>
                  <td><input type='text' name='DnsServer2'></td>
               </tr>
               <tr>
                  <td>NTP Servers:</td>
                  <td><input type='text' name='Option42'></td>
               </tr>
               <tr>
                  <td>Timezone PCode:</td>
                  <td><input type='text' name='Option100'></td>
               </tr>
               <tr>
                  <td>Timezone TCode:</td>
                  <td><input type='text' name='Option101'></td>
               </tr>

            </table>
            <br>
            <br>
            <center>
               <input type='button' onClick='btnApply()' value='Apply/Save'>
            </center>
         </form>
      </blockquote>
   </body>
</html>

